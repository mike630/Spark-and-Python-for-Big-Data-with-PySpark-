{"paragraphs":[{"text":"%pyspark\n\nfrom pyspark.sql import SparkSession\n","user":"anonymous","dateUpdated":"2020-06-20T14:09:27+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817400_-289044572","id":"20200618-223837_48434560","dateCreated":"2020-06-20T14:03:37+0000","dateStarted":"2020-06-20T14:09:27+0000","dateFinished":"2020-06-20T14:09:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7241"},{"text":"%pyspark\n\nspark = SparkSession.builder.appName('Basics').getOrCreate()","user":"anonymous","dateUpdated":"2020-06-20T14:09:30+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817404_-2123159815","id":"20200618-223923_1276511170","dateCreated":"2020-06-20T14:03:37+0000","dateStarted":"2020-06-20T14:09:30+0000","dateFinished":"2020-06-20T14:09:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7242"},{"text":"%pyspark\n\ndf = spark.read.json('s3://test-files234/Python-and-Spark-for-Big-Data-master/Spark_DataFrames/people.json')\n","user":"anonymous","dateUpdated":"2020-06-20T14:09:31+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817404_-744638275","id":"20200618-224404_876634651","dateCreated":"2020-06-20T14:03:37+0000","dateStarted":"2020-06-20T14:09:31+0000","dateFinished":"2020-06-20T14:09:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7243"},{"text":"%pyspark\n\ndf.show()\n","user":"anonymous","dateUpdated":"2020-06-20T14:09:32+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-------+\n| age|   name|\n+----+-------+\n|null|Michael|\n|  30|   Andy|\n|  19| Justin|\n+----+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817405_396470556","id":"20200618-224456_939139693","dateCreated":"2020-06-20T14:03:37+0000","dateStarted":"2020-06-20T14:09:32+0000","dateFinished":"2020-06-20T14:09:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7244"},{"text":"%pyspark\n\ndf.printSchema()","user":"anonymous","dateUpdated":"2020-06-20T14:09:34+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- age: long (nullable = true)\n |-- name: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1592661817405_1954606064","id":"20200618-224555_630691882","dateCreated":"2020-06-20T14:03:37+0000","dateStarted":"2020-06-20T14:09:34+0000","dateFinished":"2020-06-20T14:09:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7245"},{"text":"%pyspark\n\ndf.columns","user":"anonymous","dateUpdated":"2020-06-20T14:09:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['age', 'name']\n"}]},"apps":[],"jobName":"paragraph_1592661817405_1765384735","id":"20200618-224620_1073826679","dateCreated":"2020-06-20T14:03:37+0000","dateStarted":"2020-06-20T14:09:37+0000","dateFinished":"2020-06-20T14:09:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7246"},{"text":"%pyspark\n\ndf.describe()","user":"anonymous","dateUpdated":"2020-06-20T14:09:39+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[summary: string, age: string, name: string]\n"}]},"apps":[],"jobName":"paragraph_1592661817406_-1077532473","id":"20200618-224633_1377872146","dateCreated":"2020-06-20T14:03:37+0000","dateStarted":"2020-06-20T14:09:39+0000","dateFinished":"2020-06-20T14:09:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7247"},{"text":"%pyspark\n\ndf.describe().show()","user":"anonymous","dateUpdated":"2020-06-20T14:09:41+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+-------+\n|summary|               age|   name|\n+-------+------------------+-------+\n|  count|                 2|      3|\n|   mean|              24.5|   null|\n| stddev|7.7781745930520225|   null|\n|    min|                19|   Andy|\n|    max|                30|Michael|\n+-------+------------------+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817406_1253422181","id":"20200618-224645_2109398456","dateCreated":"2020-06-20T14:03:37+0000","dateStarted":"2020-06-20T14:09:41+0000","dateFinished":"2020-06-20T14:09:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7248"},{"text":"%pyspark\n\nfrom pyspark.sql.types import StructField, StringType, IntegerType, StructType","user":"anonymous","dateUpdated":"2020-06-20T14:09:45+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817406_-470924706","id":"20200618-224658_38441394","dateCreated":"2020-06-20T14:03:37+0000","dateStarted":"2020-06-20T14:09:45+0000","dateFinished":"2020-06-20T14:09:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7249"},{"text":"%pyspark\n\ndata_schema = [StructField('age', IntegerType(),True),\n                StructField('name',StringType(),True)]","user":"anonymous","dateUpdated":"2020-06-20T14:09:49+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817407_1787821990","id":"20200618-225046_254505785","dateCreated":"2020-06-20T14:03:37+0000","dateStarted":"2020-06-20T14:09:49+0000","dateFinished":"2020-06-20T14:09:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7250"},{"text":"%pyspark\n\nfinal_struc = StructType(fields = data_schema)\n","user":"anonymous","dateUpdated":"2020-06-20T14:09:50+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817407_-1371308233","id":"20200618-225417_1074719355","dateCreated":"2020-06-20T14:03:37+0000","dateStarted":"2020-06-20T14:09:50+0000","dateFinished":"2020-06-20T14:09:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7251"},{"text":"%pyspark\n\ndf = spark.read.json(\"s3://test-files234/Python-and-Spark-for-Big-Data-master/Spark_DataFrames/people.json\", schema = final_struc)\n","user":"anonymous","dateUpdated":"2020-06-20T14:09:54+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817407_-980082759","id":"20200618-225502_720039499","dateCreated":"2020-06-20T14:03:37+0000","dateStarted":"2020-06-20T14:09:54+0000","dateFinished":"2020-06-20T14:09:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7252"},{"text":"%pyspark\n\ndf.printSchema()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- age: integer (nullable = true)\n |-- name: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1592661817407_174943465","id":"20200618-225622_68341941","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7253"},{"text":"%pyspark\n\ntype(df['age'])\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pyspark.sql.column.Column'>\n"}]},"apps":[],"jobName":"paragraph_1592661817408_-2143772955","id":"20200618-225716_939223746","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7254"},{"text":"%pyspark\n\ntype(df.select('age'))","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pyspark.sql.dataframe.DataFrame'>\n"}]},"apps":[],"jobName":"paragraph_1592661817408_482497298","id":"20200618-230309_790732402","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7255"},{"text":"%pyspark\n\ndf.select('age')","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[age: int]\n"}]},"apps":[],"jobName":"paragraph_1592661817408_-1876999121","id":"20200618-230455_2013865559","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7256"},{"text":"%pyspark\n\ndf.select('age').show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+\n| age|\n+----+\n|null|\n|  30|\n|  19|\n+----+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817409_-268231652","id":"20200618-230326_952651126","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7257"},{"text":"%pyspark\n\ndf.head(2)\n","user":"anonymous","dateUpdated":"2020-06-20T14:11:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(age=None, name='Michael'), Row(age=30, name='Andy')]\n"}]},"apps":[],"jobName":"paragraph_1592662283732_566509280","id":"20200620-141123_2144353284","dateCreated":"2020-06-20T14:11:23+0000","dateStarted":"2020-06-20T14:11:33+0000","dateFinished":"2020-06-20T14:11:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7258"},{"text":"%pyspark\n\n# Get Andy name in the second row\n\ndf.head(50)[1][1]","user":"anonymous","dateUpdated":"2020-06-20T14:11:58+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'Andy'\n"}]},"apps":[],"jobName":"paragraph_1592661817409_719723447","id":"20200618-230340_1690735840","dateCreated":"2020-06-20T14:03:37+0000","dateStarted":"2020-06-20T14:11:08+0000","dateFinished":"2020-06-20T14:11:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7259"},{"text":"%pyspark\n\ndf.head(2)[0]","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(age=None, name=u'Michael')\n"}]},"apps":[],"jobName":"paragraph_1592661817409_-994527903","id":"20200618-230845_413136683","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7260"},{"text":"%pyspark\n\ntype(df.head(2)[0])\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<class 'pyspark.sql.types.Row'>\n"}]},"apps":[],"jobName":"paragraph_1592661817410_-254502915","id":"20200618-230943_1096535009","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7261"},{"text":"%md\n\n\n#### Verifica-se que há vários tipos - ROW, DATAFRAME, COLUMN e isso significa o jeito que o Spark lida dentro de um sistema distribuído de processamento e armazenamento para fazer as suas tarefas","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Verifica-se que há vários tipos - ROW, DATAFRAME, COLUMN e isso significa o jeito que o Spark lida dentro de um sistema distribuído de processamento e armazenamento para fazer as suas tarefas</h4>\n"}]},"apps":[],"jobName":"paragraph_1592661817410_1301787561","id":"20200618-230955_481667762","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7262"},{"text":"%pyspark\n\ndf.select(['age','name'])\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[age: int, name: string]\n"}]},"apps":[],"jobName":"paragraph_1592661817410_-791673566","id":"20200618-231006_1461815919","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7263"},{"text":"%pyspark\n\ndf.select(['age','name']).show()\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-------+\n| age|   name|\n+----+-------+\n|null|Michael|\n|  30|   Andy|\n|  19| Justin|\n+----+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817411_-1650819681","id":"20200618-231543_1350394850","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7264"},{"text":"%pyspark\n\ndf.withColumn('double_age',df['age']*2).show()\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-------+----------+\n| age|   name|double_age|\n+----+-------+----------+\n|null|Michael|      null|\n|  30|   Andy|        60|\n|  19| Justin|        38|\n+----+-------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817411_-1890293109","id":"20200618-231751_315005406","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7265"},{"text":"%pyspark\n\ndf.withColumnRenamed('age','my_new_age').show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+-------+\n|my_new_age|   name|\n+----------+-------+\n|      null|Michael|\n|        30|   Andy|\n|        19| Justin|\n+----------+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817411_-1710867584","id":"20200618-231836_145478901","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7266"},{"text":"%md\n\n#### Temporary SQL View","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h4>Temporary SQL View</h4>\n"}]},"apps":[],"jobName":"paragraph_1592661817412_932390011","id":"20200618-232432_1038006013","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7267"},{"text":"%pyspark\n\ndf.createOrReplaceTempView('people')","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817412_-901918420","id":"20200618-232050_2120652263","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7268"},{"text":"%pyspark\n\nresults = spark.sql(\" SELECT * FROM people\")","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817412_-788947199","id":"20200618-232416_845148904","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7269"},{"text":"%pyspark\n\nresults.show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-------+\n| age|   name|\n+----+-------+\n|null|Michael|\n|  30|   Andy|\n|  19| Justin|\n+----+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817412_-152933173","id":"20200618-232521_1867696891","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7270"},{"text":"%pyspark\n\nresults = spark.sql(\"SELECT COUNT(*) FROM people WHERE name NOT LIKE '%Micha%' \")\n\nresults.show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+\n|count(1)|\n+--------+\n|       2|\n+--------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817413_-859006040","id":"20200618-232528_87846685","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7271"},{"text":"%pyspark\n\nspark = SparkSession.builder.appName('ops').getOrCreate()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817413_2107297036","id":"20200618-235508_1441261685","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7272"},{"text":"%pyspark\n\ndf = spark.read.csv(\"s3://test-files234/Python-and-Spark-for-Big-Data-master/Spark_DataFrames/appl_stock.csv\", inferSchema = True, header = True)","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817413_1731615763","id":"20200619-000044_127719910","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7273"},{"text":"%pyspark\n\ndf.printSchema()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Date: timestamp (nullable = true)\n |-- Open: double (nullable = true)\n |-- High: double (nullable = true)\n |-- Low: double (nullable = true)\n |-- Close: double (nullable = true)\n |-- Volume: integer (nullable = true)\n |-- Adj Close: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1592661817414_1670130685","id":"20200619-000147_2111680596","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7274"},{"text":"%pyspark\n\ndf.show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------------------+------------------+------------------+------------------+---------+------------------+\n|                Date|              Open|              High|               Low|             Close|   Volume|         Adj Close|\n+--------------------+------------------+------------------+------------------+------------------+---------+------------------+\n|2010-01-04 00:00:...|        213.429998|        214.499996|212.38000099999996|        214.009998|123432400|         27.727039|\n|2010-01-05 00:00:...|        214.599998|        215.589994|        213.249994|        214.379993|150476200|27.774976000000002|\n|2010-01-06 00:00:...|        214.379993|            215.23|        210.750004|        210.969995|138040000|27.333178000000004|\n|2010-01-07 00:00:...|            211.75|        212.000006|        209.050005|            210.58|119282800|          27.28265|\n|2010-01-08 00:00:...|        210.299994|        212.000006|209.06000500000002|211.98000499999998|111902700|         27.464034|\n|2010-01-11 00:00:...|212.79999700000002|        213.000002|        208.450005|210.11000299999998|115557400|         27.221758|\n|2010-01-12 00:00:...|209.18999499999998|209.76999500000002|        206.419998|        207.720001|148614900|          26.91211|\n|2010-01-13 00:00:...|        207.870005|210.92999500000002|        204.099998|        210.650002|151473000|          27.29172|\n|2010-01-14 00:00:...|210.11000299999998|210.45999700000002|        209.020004|            209.43|108223500|         27.133657|\n|2010-01-15 00:00:...|210.92999500000002|211.59999700000003|        205.869999|            205.93|148516900|26.680197999999997|\n|2010-01-19 00:00:...|        208.330002|215.18999900000003|        207.240004|        215.039995|182501900|27.860484999999997|\n|2010-01-20 00:00:...|        214.910006|        215.549994|        209.500002|            211.73|153038200|         27.431644|\n|2010-01-21 00:00:...|        212.079994|213.30999599999998|        207.210003|        208.069996|152038600|         26.957455|\n|2010-01-22 00:00:...|206.78000600000001|        207.499996|            197.16|            197.75|220441900|         25.620401|\n|2010-01-25 00:00:...|202.51000200000001|        204.699999|        200.190002|        203.070002|266424900|26.309658000000002|\n|2010-01-26 00:00:...|205.95000100000001|        213.710005|        202.580004|        205.940001|466777500|         26.681494|\n|2010-01-27 00:00:...|        206.849995|            210.58|        199.530001|        207.880005|430642100|26.932840000000002|\n|2010-01-28 00:00:...|        204.930004|        205.500004|        198.699995|        199.289995|293375600|25.819922000000002|\n|2010-01-29 00:00:...|        201.079996|        202.199995|        190.250002|        192.060003|311488100|         24.883208|\n|2010-02-01 00:00:...|192.36999699999998|             196.0|191.29999899999999|        194.729998|187469100|         25.229131|\n+--------------------+------------------+------------------+------------------+------------------+---------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1592661817414_1694141498","id":"20200619-000244_90404964","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7275"},{"text":"%pyspark\n\ndf.head(3)","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(Date=datetime.datetime(2010, 1, 4, 0, 0), Open=213.429998, High=214.499996, Low=212.38000099999996, Close=214.009998, Volume=123432400, Adj Close=27.727039), Row(Date=datetime.datetime(2010, 1, 5, 0, 0), Open=214.599998, High=215.589994, Low=213.249994, Close=214.379993, Volume=150476200, Adj Close=27.774976000000002), Row(Date=datetime.datetime(2010, 1, 6, 0, 0), Open=214.379993, High=215.23, Low=210.750004, Close=210.969995, Volume=138040000, Adj Close=27.333178000000004)]\n"}]},"apps":[],"jobName":"paragraph_1592661817414_171623981","id":"20200619-000301_1363651217","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7276"},{"text":"%pyspark\n\ndf.filter(\"Close < 500\").show()\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------------------+------------------+------------------+------------------+---------+------------------+\n|                Date|              Open|              High|               Low|             Close|   Volume|         Adj Close|\n+--------------------+------------------+------------------+------------------+------------------+---------+------------------+\n|2010-01-04 00:00:...|        213.429998|        214.499996|212.38000099999996|        214.009998|123432400|         27.727039|\n|2010-01-05 00:00:...|        214.599998|        215.589994|        213.249994|        214.379993|150476200|27.774976000000002|\n|2010-01-06 00:00:...|        214.379993|            215.23|        210.750004|        210.969995|138040000|27.333178000000004|\n|2010-01-07 00:00:...|            211.75|        212.000006|        209.050005|            210.58|119282800|          27.28265|\n|2010-01-08 00:00:...|        210.299994|        212.000006|209.06000500000002|211.98000499999998|111902700|         27.464034|\n|2010-01-11 00:00:...|212.79999700000002|        213.000002|        208.450005|210.11000299999998|115557400|         27.221758|\n|2010-01-12 00:00:...|209.18999499999998|209.76999500000002|        206.419998|        207.720001|148614900|          26.91211|\n|2010-01-13 00:00:...|        207.870005|210.92999500000002|        204.099998|        210.650002|151473000|          27.29172|\n|2010-01-14 00:00:...|210.11000299999998|210.45999700000002|        209.020004|            209.43|108223500|         27.133657|\n|2010-01-15 00:00:...|210.92999500000002|211.59999700000003|        205.869999|            205.93|148516900|26.680197999999997|\n|2010-01-19 00:00:...|        208.330002|215.18999900000003|        207.240004|        215.039995|182501900|27.860484999999997|\n|2010-01-20 00:00:...|        214.910006|        215.549994|        209.500002|            211.73|153038200|         27.431644|\n|2010-01-21 00:00:...|        212.079994|213.30999599999998|        207.210003|        208.069996|152038600|         26.957455|\n|2010-01-22 00:00:...|206.78000600000001|        207.499996|            197.16|            197.75|220441900|         25.620401|\n|2010-01-25 00:00:...|202.51000200000001|        204.699999|        200.190002|        203.070002|266424900|26.309658000000002|\n|2010-01-26 00:00:...|205.95000100000001|        213.710005|        202.580004|        205.940001|466777500|         26.681494|\n|2010-01-27 00:00:...|        206.849995|            210.58|        199.530001|        207.880005|430642100|26.932840000000002|\n|2010-01-28 00:00:...|        204.930004|        205.500004|        198.699995|        199.289995|293375600|25.819922000000002|\n|2010-01-29 00:00:...|        201.079996|        202.199995|        190.250002|        192.060003|311488100|         24.883208|\n|2010-02-01 00:00:...|192.36999699999998|             196.0|191.29999899999999|        194.729998|187469100|         25.229131|\n+--------------------+------------------+------------------+------------------+------------------+---------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1592661817415_-707114071","id":"20200619-000404_1744498162","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7277"},{"text":"%pyspark\n\ndf.count()\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1762\n"}]},"apps":[],"jobName":"paragraph_1592661817415_961749339","id":"20200619-000541_1134882360","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7278"},{"text":"%pyspark\n\ndf.filter(\"Open > 210\").select(['Open','Close']).show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+------------------+\n|              Open|             Close|\n+------------------+------------------+\n|        213.429998|        214.009998|\n|        214.599998|        214.379993|\n|        214.379993|        210.969995|\n|            211.75|            210.58|\n|        210.299994|211.98000499999998|\n|212.79999700000002|210.11000299999998|\n|210.11000299999998|            209.43|\n|210.92999500000002|            205.93|\n|        214.910006|            211.73|\n|        212.079994|        208.069996|\n|        214.940006|218.95000499999998|\n|220.01000200000001|        219.079994|\n|218.31000299999997|        223.020004|\n|        223.829996|224.83999300000002|\n|        223.909998|        225.500008|\n|         227.37001|        226.600006|\n|225.38000499999998|223.83999599999999|\n|        224.180004|224.44999700000002|\n|        224.899994|224.12000299999997|\n|        224.100002|        224.650002|\n+------------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1592661817415_-1843145875","id":"20200619-000614_1340972176","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7279"},{"text":"%pyspark\n\ndf.filter(df['Open'] > 210).select(['Open','Close']).show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+------------------+\n|              Open|             Close|\n+------------------+------------------+\n|        213.429998|        214.009998|\n|        214.599998|        214.379993|\n|        214.379993|        210.969995|\n|            211.75|            210.58|\n|        210.299994|211.98000499999998|\n|212.79999700000002|210.11000299999998|\n|210.11000299999998|            209.43|\n|210.92999500000002|            205.93|\n|        214.910006|            211.73|\n|        212.079994|        208.069996|\n|        214.940006|218.95000499999998|\n|220.01000200000001|        219.079994|\n|218.31000299999997|        223.020004|\n|        223.829996|224.83999300000002|\n|        223.909998|        225.500008|\n|         227.37001|        226.600006|\n|225.38000499999998|223.83999599999999|\n|        224.180004|224.44999700000002|\n|        224.899994|224.12000299999997|\n|        224.100002|        224.650002|\n+------------------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1592661817416_-1928211325","id":"20200619-000741_2036651273","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7280"},{"text":"%pyspark\n\ndf.filter((df['Close'] < 200) & (df['Open'] > 200)).show()\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------------------+----------+----------+----------+---------+------------------+\n|                Date|              Open|      High|       Low|     Close|   Volume|         Adj Close|\n+--------------------+------------------+----------+----------+----------+---------+------------------+\n|2010-01-22 00:00:...|206.78000600000001|207.499996|    197.16|    197.75|220441900|         25.620401|\n|2010-01-28 00:00:...|        204.930004|205.500004|198.699995|199.289995|293375600|25.819922000000002|\n|2010-01-29 00:00:...|        201.079996|202.199995|190.250002|192.060003|311488100|         24.883208|\n+--------------------+------------------+----------+----------+----------+---------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817416_1511542291","id":"20200619-001043_1544523187","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7281"},{"text":"%pyspark\n\ndf.filter((df['Close'] < 200) & ~(df['Open'] > 200)).show()\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------------------+------------------+------------------+------------------+---------+------------------+\n|                Date|              Open|              High|               Low|             Close|   Volume|         Adj Close|\n+--------------------+------------------+------------------+------------------+------------------+---------+------------------+\n|2010-02-01 00:00:...|192.36999699999998|             196.0|191.29999899999999|        194.729998|187469100|         25.229131|\n|2010-02-02 00:00:...|        195.909998|        196.319994|193.37999299999998|        195.859997|174585600|25.375532999999997|\n|2010-02-03 00:00:...|        195.169994|        200.200003|        194.420004|        199.229994|153832000|25.812148999999998|\n|2010-02-04 00:00:...|        196.730003|        198.370001|        191.570005|        192.050003|189413000|         24.881912|\n|2010-02-05 00:00:...|192.63000300000002|             196.0|        190.850002|        195.460001|212576700|25.323710000000002|\n|2010-02-08 00:00:...|        195.690006|197.88000300000002|        193.999994|194.11999699999998|119567700|           25.1501|\n|2010-02-09 00:00:...|        196.419996|        197.499994|        194.749998|196.19000400000002|158221700|         25.418289|\n|2010-02-10 00:00:...|        195.889997|             196.6|            194.26|195.12000700000002| 92590400|          25.27966|\n|2010-02-11 00:00:...|        194.880001|        199.750006|194.05999599999998|        198.669994|137586400|         25.739595|\n|2010-02-23 00:00:...|        199.999998|        201.330002|        195.709993|        197.059998|143773700|         25.531005|\n|2014-06-09 00:00:...|         92.699997|         93.879997|             91.75|         93.699997| 75415000|         88.906324|\n|2014-06-10 00:00:...|         94.730003|         95.050003|             93.57|             94.25| 62777000|         89.428189|\n|2014-06-11 00:00:...|         94.129997|         94.760002|         93.470001|         93.860001| 45681000|         89.058142|\n|2014-06-12 00:00:...|         94.040001|         94.120003|         91.900002|         92.290001| 54749000|         87.568463|\n|2014-06-13 00:00:...|         92.199997|         92.440002|         90.879997|         91.279999| 54525000|         86.610132|\n|2014-06-16 00:00:...|         91.510002|             92.75|         91.449997|         92.199997| 35561000|         87.483064|\n|2014-06-17 00:00:...|         92.309998|         92.699997|         91.800003| 92.08000200000001| 29726000| 87.36920699999999|\n|2014-06-18 00:00:...|         92.269997|         92.290001|         91.349998|             92.18| 33514000|          87.46409|\n|2014-06-19 00:00:...|         92.290001|         92.300003|         91.339996|         91.860001| 35528000|         87.160461|\n|2014-06-20 00:00:...|         91.849998|         92.550003|         90.900002|         90.910004|100898000|         86.259066|\n+--------------------+------------------+------------------+------------------+------------------+---------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1592661817416_447752366","id":"20200619-002108_1233091569","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7282"},{"text":"%pyspark\n\ndf.filter(df['Low'] == 197.16).show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------------------+----------+------+------+---------+---------+\n|                Date|              Open|      High|   Low| Close|   Volume|Adj Close|\n+--------------------+------------------+----------+------+------+---------+---------+\n|2010-01-22 00:00:...|206.78000600000001|207.499996|197.16|197.75|220441900|25.620401|\n+--------------------+------------------+----------+------+------+---------+---------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817417_156296091","id":"20200619-002325_1590685924","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7283"},{"text":"%pyspark\n\nresults = df.filter(df['Low'] == 197.16).collect()\n\nresults","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(Date=datetime.datetime(2010, 1, 22, 0, 0), Open=206.78000600000001, High=207.499996, Low=197.16, Close=197.75, Volume=220441900, Adj Close=25.620401)]\n"}]},"apps":[],"jobName":"paragraph_1592661817417_1226037014","id":"20200619-003040_1552231206","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7284"},{"text":"%pyspark\n\nresults[0][1]","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"206.78000600000001\n"}]},"apps":[],"jobName":"paragraph_1592661817417_-906609292","id":"20200619-003206_492397637","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7285"},{"text":"%pyspark\n\nrow = results[0]\n\nrow.asDict()\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"{'Volume': 220441900, 'Adj Close': 25.620401, 'High': 207.499996, 'Low': 197.16, 'Date': datetime.datetime(2010, 1, 22, 0, 0), 'Close': 197.75, 'Open': 206.78000600000001}\n"}]},"apps":[],"jobName":"paragraph_1592661817418_481239097","id":"20200619-004512_1683727974","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7286"},{"text":"%pyspark\nrow.asDict()['High']\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"207.499996\n"}]},"apps":[],"jobName":"paragraph_1592661817418_-168142351","id":"20200619-004557_170943577","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7287"},{"text":"%pyspark\n\nspark = SparkSession.builder.appName('aggs').getOrCreate()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817418_-691109903","id":"20200619-004627_1565436904","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7288"},{"text":"%pyspark\n\ndf = spark.read.csv(\"s3://test-files234/Python-and-Spark-for-Big-Data-master/Spark_DataFrames/sales_info.csv\", inferSchema = True, header = True)","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817418_575025607","id":"20200620-041911_1572963496","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7289"},{"text":"%pyspark\n\ndf.show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------+-----+\n|Company| Person|Sales|\n+-------+-------+-----+\n|   GOOG|    Sam|200.0|\n|   GOOG|Charlie|120.0|\n|   GOOG|  Frank|340.0|\n|   MSFT|   Tina|600.0|\n|   MSFT|    Amy|124.0|\n|   MSFT|Vanessa|243.0|\n|     FB|   Carl|870.0|\n|     FB|  Sarah|350.0|\n|   APPL|   John|250.0|\n|   APPL|  Linda|130.0|\n|   APPL|   Mike|750.0|\n|   APPL|  Chris|350.0|\n+-------+-------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817419_721083272","id":"20200620-042019_1288467666","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7290"},{"text":"%pyspark\n\ndf.printSchema()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Company: string (nullable = true)\n |-- Person: string (nullable = true)\n |-- Sales: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1592661817419_827848230","id":"20200620-042027_381882698","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7291"},{"text":"%pyspark\n\ndf.groupBy(\"Company\")\n\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.group.GroupedData object at 0x7f000f6204d0>\n"}]},"apps":[],"jobName":"paragraph_1592661817419_45503850","id":"20200620-042055_1801522596","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7292"},{"text":"%pyspark\n\ndf.groupBy('Company').mean()\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[Company: string, avg(Sales): double]\n"}]},"apps":[],"jobName":"paragraph_1592661817420_-1142252703","id":"20200620-042651_1203565237","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7293"},{"text":"%pyspark\n\ndf.groupBy('Company').mean().show()\n\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------+\n|Company|       avg(Sales)|\n+-------+-----------------+\n|   APPL|            370.0|\n|   GOOG|            220.0|\n|   MSFT|322.3333333333333|\n|     FB|            610.0|\n+-------+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817420_2118919989","id":"20200620-042732_56317428","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7294"},{"text":"%pyspark\n\ndf.groupBy('Company').sum().show()\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----------+\n|Company|sum(Sales)|\n+-------+----------+\n|   APPL|    1480.0|\n|   GOOG|     660.0|\n|   MSFT|     967.0|\n|     FB|    1220.0|\n+-------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817420_-843114228","id":"20200620-042756_554207838","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7295"},{"text":"%pyspark\n\ndf.groupBy('Company').max().show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----------+\n|Company|max(Sales)|\n+-------+----------+\n|   APPL|     750.0|\n|   GOOG|     340.0|\n|   MSFT|     600.0|\n|     FB|     870.0|\n+-------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817421_1560289477","id":"20200620-042830_2106338384","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7296"},{"text":"%pyspark\n\ndf.groupBy('Company').min().show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----------+\n|Company|min(Sales)|\n+-------+----------+\n|   APPL|     130.0|\n|   GOOG|     120.0|\n|   MSFT|     124.0|\n|     FB|     350.0|\n+-------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817421_-976015084","id":"20200620-042836_1547553306","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7297"},{"text":"%pyspark\n\ndf.groupBy('Company').avg().show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------+\n|Company|       avg(Sales)|\n+-------+-----------------+\n|   APPL|            370.0|\n|   GOOG|            220.0|\n|   MSFT|322.3333333333333|\n|     FB|            610.0|\n+-------+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817421_-420084707","id":"20200620-042847_1078121028","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7298"},{"text":"%pyspark\n\ndf.groupBy('Company').count().show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----+\n|Company|count|\n+-------+-----+\n|   APPL|    4|\n|   GOOG|    3|\n|   MSFT|    3|\n|     FB|    2|\n+-------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817422_1708239145","id":"20200620-042858_1667337109","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7299"},{"text":"%pyspark\n\ndf.groupBy(df.Company).mean().show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------------+\n|Company|       avg(Sales)|\n+-------+-----------------+\n|   APPL|            370.0|\n|   GOOG|            220.0|\n|   MSFT|322.3333333333333|\n|     FB|            610.0|\n+-------+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817422_545571663","id":"20200620-042924_209699881","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7300"},{"text":"%pyspark\n\ndf.agg({'Sales':'count'}).show()\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+\n|count(Sales)|\n+------------+\n|          12|\n+------------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817422_62841279","id":"20200620-043324_1366115328","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7301"},{"text":"%pyspark\n\ngroup_data = df.groupBy(\"Company\")\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817422_1608828195","id":"20200620-044518_1235464713","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7302"},{"text":"%pyspark\n\ngroup_data.agg({'Sales':'count'}).show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------+\n|Company|count(Sales)|\n+-------+------------+\n|   APPL|           4|\n|   GOOG|           3|\n|   MSFT|           3|\n|     FB|           2|\n+-------+------------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817423_-1955829449","id":"20200620-044609_1970196706","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7303"},{"text":"%pyspark\n\nfrom pyspark.sql.functions import countDistinct, avg,stddev, count\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817423_281218023","id":"20200620-044648_1248760162","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7304"},{"text":"%pyspark\n\ndf.select(countDistinct(\"Sales\")).show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------+\n|count(DISTINCT Sales)|\n+---------------------+\n|                   11|\n+---------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817423_-350847985","id":"20200620-045011_825482262","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7305"},{"text":"%pyspark\n\ndf.select(avg(df.Sales)).show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+\n|       avg(Sales)|\n+-----------------+\n|360.5833333333333|\n+-----------------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817424_-1500660543","id":"20200620-045211_1613430728","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7306"},{"text":"%pyspark\n\ndf.select(count('Company')).show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+\n|count(Company)|\n+--------------+\n|            12|\n+--------------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817424_2123703357","id":"20200620-045231_1667378508","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7307"},{"text":"%pyspark\n\ndf.select(countDistinct(df.Company)).show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------------+\n|count(DISTINCT Company)|\n+-----------------------+\n|                      4|\n+-----------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817424_-518060364","id":"20200620-045346_413229443","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7308"},{"text":"%pyspark\n\ndf.select(countDistinct(df.Company).alias('Posso renomear do jeito que eu quiser com .alias()')).show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------------------------------------+\n|Posso renomear do jeito que eu quiser com .alias()|\n+--------------------------------------------------+\n|                                                 4|\n+--------------------------------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817425_-980174696","id":"20200620-045410_694250147","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7309"},{"text":"%pyspark\n\ndf.select(stddev('Sales')).show()\n","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+\n|stddev_samp(Sales)|\n+------------------+\n|250.08742410799007|\n+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817425_2044868972","id":"20200620-045518_1265645414","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7310"},{"text":"%pyspark\n\nfrom pyspark.sql.functions import format_number","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817425_1346207500","id":"20200620-045708_1316434637","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7311"},{"text":"%pyspark\n\nsales_std = df.select(stddev('Sales').alias('std'))","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817426_1329685210","id":"20200620-045732_43886323","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7312"},{"text":"%pyspark\n\nsales_std.select(format_number('std', 2).alias('std')).show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+\n|   std|\n+------+\n|250.09|\n+------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817426_-1044697024","id":"20200620-045929_745937224","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7313"},{"text":"%pyspark\n\ndf.orderBy(\"Sales\").show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------+-----+\n|Company| Person|Sales|\n+-------+-------+-----+\n|   GOOG|Charlie|120.0|\n|   MSFT|    Amy|124.0|\n|   APPL|  Linda|130.0|\n|   GOOG|    Sam|200.0|\n|   MSFT|Vanessa|243.0|\n|   APPL|   John|250.0|\n|   GOOG|  Frank|340.0|\n|     FB|  Sarah|350.0|\n|   APPL|  Chris|350.0|\n|   MSFT|   Tina|600.0|\n|   APPL|   Mike|750.0|\n|     FB|   Carl|870.0|\n+-------+-------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817426_-1681432688","id":"20200620-045943_423236531","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7314"},{"text":"%pyspark\n\ndf.orderBy(df.Sales.desc()).show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------+-----+\n|Company| Person|Sales|\n+-------+-------+-----+\n|     FB|   Carl|870.0|\n|   APPL|   Mike|750.0|\n|   MSFT|   Tina|600.0|\n|     FB|  Sarah|350.0|\n|   APPL|  Chris|350.0|\n|   GOOG|  Frank|340.0|\n|   APPL|   John|250.0|\n|   MSFT|Vanessa|243.0|\n|   GOOG|    Sam|200.0|\n|   APPL|  Linda|130.0|\n|   MSFT|    Amy|124.0|\n|   GOOG|Charlie|120.0|\n+-------+-------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817427_99940887","id":"20200620-050936_1627166667","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7315"},{"text":"%pyspark\n\ndf.orderBy(df['Sales'].desc()).show()","user":"anonymous","dateUpdated":"2020-06-20T14:03:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------+-----+\n|Company| Person|Sales|\n+-------+-------+-----+\n|     FB|   Carl|870.0|\n|   APPL|   Mike|750.0|\n|   MSFT|   Tina|600.0|\n|     FB|  Sarah|350.0|\n|   APPL|  Chris|350.0|\n|   GOOG|  Frank|340.0|\n|   APPL|   John|250.0|\n|   MSFT|Vanessa|243.0|\n|   GOOG|    Sam|200.0|\n|   APPL|  Linda|130.0|\n|   MSFT|    Amy|124.0|\n|   GOOG|Charlie|120.0|\n+-------+-------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1592661817427_1392884182","id":"20200620-051019_2074883576","dateCreated":"2020-06-20T14:03:37+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7316"},{"text":"%pyspark\n\nfrom pyspark.sql import SparkSession\n# May take a little while on a local computer\nspark = SparkSession.builder.appName(\"missingdata\").getOrCreate()","user":"anonymous","dateUpdated":"2020-06-20T14:16:42+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661817427_-2056162966","id":"20200620-051037_1213713319","dateCreated":"2020-06-20T14:03:37+0000","dateStarted":"2020-06-20T14:16:42+0000","dateFinished":"2020-06-20T14:16:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7317"},{"text":"%pyspark\n\ndf = spark.read.csv(\"s3://test-files234/Python-and-Spark-for-Big-Data-master/Spark_DataFrames/ContainsNull.csv\",header=True,inferSchema=True)","user":"anonymous","dateUpdated":"2020-06-20T14:16:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1592661833787_301734350","id":"20200620-140353_2077134750","dateCreated":"2020-06-20T14:03:53+0000","dateStarted":"2020-06-20T14:16:44+0000","dateFinished":"2020-06-20T14:16:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7318"},{"text":"%pyspark\n\ndf.show()","user":"anonymous","dateUpdated":"2020-06-20T14:27:10+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1592663211633_2066882576","id":"20200620-142651_620586402","dateCreated":"2020-06-20T14:26:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14283","dateFinished":"2020-06-20T14:27:11+0000","dateStarted":"2020-06-20T14:27:10+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+-----+\n|  Id| Name|Sales|\n+----+-----+-----+\n|emp1| John| null|\n|emp2| null| null|\n|emp3| null|345.0|\n|emp4|Cindy|456.0|\n+----+-----+-----+\n\n"}]}},{"text":"%pyspark\n\nfrom pyspark.sql.functions import mean\n\nmean_val = df.select(mean(df['Sales']).alias('average')).collect()\nmean_val[0]['average']","user":"anonymous","dateUpdated":"2020-06-20T14:24:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"400.5\n"}]},"apps":[],"jobName":"paragraph_1592661898600_-241142409","id":"20200620-140458_821101443","dateCreated":"2020-06-20T14:04:58+0000","dateStarted":"2020-06-20T14:24:44+0000","dateFinished":"2020-06-20T14:24:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7319"},{"text":"%pyspark\n\n\ndf.select(mean(df['Sales'])).show()\n","user":"anonymous","dateUpdated":"2020-06-20T14:06:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+\n|avg(Sales)|\n+----------+\n|     400.5|\n+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1592661930782_1894948969","id":"20200620-140530_704292934","dateCreated":"2020-06-20T14:05:30+0000","dateStarted":"2020-06-20T14:06:57+0000","dateFinished":"2020-06-20T14:07:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7320"},{"text":"%pyspark\n\nmean_sales = mean_val[0][0]\n\n\ndf2 = df.na.fill(mean_sales,['Sales'])\n\ndf2.show()","user":"anonymous","dateUpdated":"2020-06-20T14:39:06+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+-----+\n|  Id| Name|Sales|\n+----+-----+-----+\n|emp1| John|400.5|\n|emp2| null|400.5|\n|emp3| null|345.0|\n|emp4|Cindy|456.0|\n+----+-----+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1592661940144_-1256379702","id":"20200620-140540_180143130","dateCreated":"2020-06-20T14:05:40+0000","dateStarted":"2020-06-20T14:39:06+0000","dateFinished":"2020-06-20T14:39:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7321"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1592662992347_1251917100","id":"20200620-142312_828881926","dateCreated":"2020-06-20T14:23:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7322","text":"%pyspark\n\ndf3 = df2.na.fill({'Id':'emp2','Name':'Maycon', 'Sales':'450'})\n\ndf3.show()","dateUpdated":"2020-06-20T14:40:04+0000","dateFinished":"2020-06-20T14:40:04+0000","dateStarted":"2020-06-20T14:40:04+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+------+-----+\n|  Id|  Name|Sales|\n+----+------+-----+\n|emp1|  John|400.5|\n|emp2|Maycon|400.5|\n|emp3|Maycon|345.0|\n|emp4| Cindy|456.0|\n+----+------+-----+\n\n"}]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-06-20T14:35:54+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1592663754506_525819804","id":"20200620-143554_647838034","dateCreated":"2020-06-20T14:35:54+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14722"}],"name":"Spark DataFrame Basics","id":"2FDYCQNSE","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}